{
    "categories": [
        {
            "name": "Terraform Core Concepts",
            "subcategories": [
                {
                    "name": "Project & Provider Setup",
                    "commands": [
                        {
                            "command": "terraform init",
                            "syntax": "terraform init",
                            "description": "Initializes a new or existing Terraform configuration, downloading provider plugins and setting up the backend.",
                            "why": "This is the first command you run in any Terraform project. It prepares your environment for all other Terraform operations.",
                            "when": "Run this command whenever you start a new project or when you change provider versions or backend configurations.",
                            "example": "provider \"google\" {\n  project = \"your-gcp-project-id\"\n  region  = \"us-central1\"\n}\n\nterraform {\n  required_providers {\n    google = {\n      source  = \"hashicorp/google\",\n      version = \"~> 4.0\"\n    }\n  }\n  backend \"gcs\" {\n    bucket = \"tf-state-bucket\",\n    prefix = \"terraform/state\"\n  }\n}",
                            "version": "Terraform >= 0.12"
                        },
                        {
                            "command": "terraform plan",
                            "syntax": "terraform plan [-out=PATH]",
                            "description": "Generates an execution plan, showing what actions Terraform will take to achieve the desired state defined in your configuration.",
                            "why": "Crucial for reviewing changes before applying them, preventing unintended infrastructure modifications.",
                            "when": "Always run `terraform plan` before `terraform apply` to understand the impact of your configuration changes.",
                            "example": "terraform plan -out=tfplan",
                            "version": "Terraform >= 0.12"
                        },
                        {
                            "command": "terraform apply",
                            "syntax": "terraform apply [PATH]",
                            "description": "Applies the changes required to reach the desired state of the configuration. It can optionally use a plan file generated by `terraform plan`.",
                            "why": "To create, update, or delete infrastructure resources according to your Terraform configuration.",
                            "when": "After reviewing and approving a `terraform plan`, use this to provision or modify your infrastructure.",
                            "example": "terraform apply tfplan",
                            "version": "Terraform >= 0.12"
                        },
                        {
                            "command": "terraform destroy",
                            "syntax": "terraform destroy",
                            "description": "Destroys all remote objects managed by the current Terraform configuration.",
                            "why": "To tear down infrastructure when it's no longer needed, reducing costs and preventing orphaned resources.",
                            "when": "Use with extreme caution when decommissioning environments, testing, or cleaning up resources.",
                            "example": "terraform destroy",
                            "version": "Terraform >= 0.12"
                        }
                    ]
                },
                {
                    "name": "Variables & Outputs",
                    "commands": [
                        {
                            "command": "variable \"[VARIABLE_NAME]\"",
                            "syntax": "variable \"[VARIABLE_NAME]\" {\n  type        = [TYPE]\n  description = \"[DESCRIPTION]\"\n  default     = [DEFAULT_VALUE]\n}",
                            "description": "Defines an input variable, allowing you to parameterize your Terraform configurations for reusability and flexibility.",
                            "why": "Variables decouple configuration values from the code, making modules reusable across different environments or projects.",
                            "when": "Use variables for any values that might change between deployments, such as project IDs, regions, network names, or instance types.",
                            "example": "variable \"project_id\" {\n  type        = string,\n  description = \"The GCP project ID to deploy resources into.\"\n}\n\nvariable \"region\" {\n  type        = string,\n  default     = \"us-central1\",\n  description = \"The GCP region for resource deployment.\"\n}",
                            "version": "Terraform >= 0.12"
                        },
                        {
                            "command": "output \"[OUTPUT_NAME]\"",
                            "syntax": "output \"[OUTPUT_NAME]\" {\n  value       = [EXPRESSION]\n  description = \"[DESCRIPTION]\"\n}",
                            "description": "Defines an output value, which is displayed to the user after `terraform apply` and can be consumed by other Terraform configurations or external tools.",
                            "why": "Outputs provide a way to easily extract and share important information about the infrastructure created by Terraform, like IP addresses, DNS names, or resource IDs.",
                            "when": "When you need to expose data from your infrastructure for consumption by other modules, CI/CD pipelines, or simply for quick reference.",
                            "example": "output \"vpc_self_link\" {\n  value       = google_compute_network.main_vpc.self_link,\n  description = \"The self-link of the main VPC network.\"\n}\n\noutput \"subnet_cidr\" {\n  value       = google_compute_subnetwork.main_subnet.ip_cidr_range,\n  description = \"The CIDR range of the main subnet.\"\n}",
                            "version": "Terraform >= 0.12"
                        }
                    ]
                },
                {
                    "name": "Code Formatting & Validation",
                    "commands": [
                        {
                            "command": "terraform fmt",
                            "syntax": "terraform fmt [-recursive] [DIR]",
                            "description": "Rewrites Terraform configuration files to a canonical format, improving readability and consistency.",
                            "why": "Ensures a consistent code style across your team and projects, making configurations easier to read and review.",
                            "when": "Run this command regularly before committing your Terraform code to maintain a clean and standardized codebase.",
                            "example": "terraform fmt -recursive .",
                            "version": "Terraform >= 0.12"
                        },
                        {
                            "command": "terraform validate",
                            "syntax": "terraform validate [DIR]",
                            "description": "Validates the configuration files in a directory, checking for syntax errors and internal consistency.",
                            "why": "Catches configuration errors early in the development cycle, before attempting to create or modify real infrastructure.",
                            "when": "Run this command frequently during development and as a pre-commit hook in your CI/CD pipeline.",
                            "example": "terraform validate",
                            "version": "Terraform >= 0.12"
                        }
                    ]
                }
            ]
        },
        {
            "name": "GCP Networking with Terraform",
            "subcategories": [
                {
                    "name": "VPC & Subnets",
                    "commands": [
                        {
                            "command": "google_compute_network",
                            "syntax": "resource \"google_compute_network\" \"[NAME]\" {\n  name                    = \"[NETWORK_NAME]\"\n  auto_create_subnetworks = [true/false]\n  routing_mode            = \"[REGIONAL/GLOBAL]\"\n}",
                            "description": "Manages a Google Compute Engine VPC network resource.",
                            "why": "To define the primary isolated network where all your GCP resources will reside. `auto_create_subnetworks = false` is generally recommended for explicit control.",
                            "when": "When you need to create a new, logically isolated network space in GCP for your applications.",
                            "example": "resource \"google_compute_network\" \"main_vpc\" {\n  name                    = \"production-vpc\",\n  auto_create_subnetworks = false,\n  routing_mode            = \"REGIONAL\"\n}",
                            "version": "Google Provider >= 4.0"
                        },
                        {
                            "command": "google_compute_subnetwork",
                            "syntax": "resource \"google_compute_subnetwork\" \"[NAME]\" {\n  name          = \"[SUBNET_NAME]\"\n  ip_cidr_range = \"[CIDR_RANGE]\"\n  network       = google_compute_network.[VPC_RESOURCE_NAME].id\n  region        = \"[REGION]\"\n}",
                            "description": "Manages a Google Compute Engine subnetwork resource within a VPC.",
                            "why": "To logically partition your VPC into smaller IP ranges for resource deployment and to control network flow with firewall rules.",
                            "when": "After defining your main VPC, you create subnetworks in specific regions for your virtual machines, databases, and other services.",
                            "example": "resource \"google_compute_subnetwork\" \"web_subnet\" {\n  name          = \"web-subnet\",\n  ip_cidr_range = \"10.10.10.0/24\",\n  network       = google_compute_network.main_vpc.id,\n  region        = \"us-central1\"\n}\n\nresource \"google_compute_subnetwork\" \"app_subnet\" {\n  name          = \"app-subnet\",\n  ip_cidr_range = \"10.10.20.0/24\",\n  network       = google_compute_network.main_vpc.id,\n  region        = \"us-central1\"\n}",
                            "version": "Google Provider >= 4.0"
                        }
                    ]
                },
                {
                    "name": "Firewall Rules",
                    "commands": [
                        {
                            "command": "google_compute_firewall",
                            "syntax": "resource \"google_compute_firewall\" \"[NAME]\" {\n  name        = \"[FIREWALL_RULE_NAME]\"\n  network     = google_compute_network.[VPC_RESOURCE_NAME].name\n  allow {\n    protocol = \"[PROTOCOL]\"\n    ports    = [\"[PORT]\"]\n  }\n  source_ranges = [\"[IP_RANGE]\"]\n  target_tags   = [\"[TAG]\"]\n}",
                            "description": "Manages a Google Compute Engine firewall rule resource.",
                            "why": "To secure your network by explicitly allowing or denying traffic based on various criteria (protocol, port, source/destination, tags).",
                            "when": "When you need to control access to your instances, define ingress/egress policies, or implement network segmentation.",
                            "example": "resource \"google_compute_firewall\" \"allow_ssh\" {\n  name        = \"allow-ssh-from-iap\",\n  network     = google_compute_network.main_vpc.name,\n  allow {\n    protocol = \"tcp\",\n    ports    = [\"22\"]\n  },\n  source_ranges = [\"35.235.240.0/20\"], # Google Cloud IAP IP range\n  target_tags   = [\"ssh-enabled-instances\"]\n}\n\nresource \"google_compute_firewall\" \"allow_http_https\" {\n  name        = \"allow-http-https\",\n  network     = google_compute_network.main_vpc.name,\n  allow {\n    protocol = \"tcp\",\n    ports    = [\"80\", \"443\"]\n  },\n  source_ranges = [\"0.0.0.0/0\"],\n  target_tags   = [\"web-servers\"]\n}",
                            "version": "Google Provider >= 4.0"
                        }
                    ]
                },
                {
                    "name": "HA VPN & Cloud Router",
                    "commands": [
                        {
                            "command": "google_compute_router",
                            "syntax": "resource \"google_compute_router\" \"[NAME]\" {\n  name    = \"[ROUTER_NAME]\"\n  region  = \"[REGION]\"\n  network = google_compute_network.[VPC_RESOURCE_NAME].name\n  asn     = \"[LOCAL_ASN]\"\n}",
                            "description": "Manages a Cloud Router resource, enabling dynamic routing (BGP) for hybrid connectivity.",
                            "why": "Cloud Router is essential for HA VPN and Cloud Interconnect, facilitating automatic route exchange between GCP and on-premises networks.",
                            "when": "When setting up HA VPN tunnels or Cloud Interconnect for dynamic routing.",
                            "example": "resource \"google_compute_router\" \"main_router\" {\n  name    = \"gcp-router-us-central1\",\n  region  = \"us-central1\",\n  network = google_compute_network.main_vpc.name,\n  asn     = 64512\n}",
                            "version": "Google Provider >= 4.0"
                        },
                        {
                            "command": "google_compute_vpn_gateway",
                            "syntax": "resource \"google_compute_vpn_gateway\" \"[NAME]\" {\n  name    = \"[VPN_GATEWAY_NAME]\"\n  network = google_compute_network.[VPC_RESOURCE_NAME].name\n  region  = \"[REGION]\"\n}",
                            "description": "Manages a Classic VPN Gateway resource.",
                            "why": "To create an IPsec VPN tunnel between your GCP VPC and another network using a single tunnel.",
                            "when": "When you require a basic, non-HA VPN connection to a peer network.",
                            "example": "resource \"google_compute_vpn_gateway\" \"classic_vpn_gw\" {\n  name    = \"classic-vpn-gateway\",\n  network = google_compute_network.main_vpc.name,\n  region  = \"us-central1\"\n}",
                            "version": "Google Provider >= 4.0"
                        },
                        {
                            "command": "google_compute_vpn_tunnel",
                            "syntax": "resource \"google_compute_vpn_tunnel\" \"[NAME]\" {\n  name                  = \"[TUNNEL_NAME]\"\n  region                = \"[REGION]\"\n  vpn_gateway           = google_compute_vpn_gateway.[VPN_GW_RESOURCE_NAME].id\n  shared_secret         = \"[SHARED_SECRET]\"\n  peer_ip               = \"[PEER_IP_ADDRESS]\"\n  ike_version           = 2\n  local_traffic_selector  = [\"0.0.0.0/0\"]\n  remote_traffic_selector = [\"0.0.0.0/0\"]\n}",
                            "description": "Manages a Classic VPN Tunnel resource.",
                            "why": "To establish the encrypted tunnel for a Classic VPN Gateway.",
                            "when": "After defining a Classic VPN Gateway and having the peer IP address and shared secret from the on-premises side.",
                            "example": "resource \"google_compute_vpn_tunnel\" \"classic_vpn_tunnel\" {\n  name                  = \"classic-vpn-tunnel\",\n  region                = \"us-central1\",\n  vpn_gateway           = google_compute_vpn_gateway.classic_vpn_gw.id,\n  shared_secret         = \"a_very_secure_secret\",\n  peer_ip               = \"203.0.113.10\",\n  ike_version           = 2,\n  local_traffic_selector  = [\"0.0.0.0/0\"],\n  remote_traffic_selector = [\"192.168.1.0/24\", \"192.168.2.0/24\"]\n}",
                            "version": "Google Provider >= 4.0"
                        },
                        {
                            "command": "google_compute_ha_vpn_gateway",
                            "syntax": "resource \"google_compute_ha_vpn_gateway\" \"[NAME]\" {\n  name    = \"[HA_VPN_GATEWAY_NAME]\"\n  region  = \"[REGION]\"\n  network = google_compute_network.[VPC_RESOURCE_NAME].id\n}",
                            "description": "Manages a Highly Available (HA) VPN Gateway resource.",
                            "why": "Provides a highly available and fault-tolerant VPN connection to your on-premises network with two interfaces and redundant tunnels.",
                            "when": "When you need a production-grade, resilient VPN connection for critical hybrid cloud workloads.",
                            "example": "resource \"google_compute_ha_vpn_gateway\" \"ha_vpn_gw\" {\n  name    = \"gcp-ha-vpn-gateway\",\n  region  = \"us-central1\",\n  network = google_compute_network.main_vpc.id\n}",
                            "version": "Google Provider >= 4.0"
                        },
                        {
                            "command": "google_compute_vpn_tunnel (HA VPN)",
                            "syntax": "resource \"google_compute_vpn_tunnel\" \"[NAME]\" {\n  name                         = \"[TUNNEL_NAME]\"\n  region                       = \"[REGION]\"\n  ha_vpn_gateway               = google_compute_ha_vpn_gateway.[HA_VPN_GW_RESOURCE_NAME].id\n  vpn_gateway_interface        = [INTERFACE_INDEX] # 0 or 1\n  shared_secret                = \"[SHARED_SECRET]\"\n  peer_external_gateway        = google_compute_external_vpn_gateway.[EXTERNAL_GW_RESOURCE_NAME].id\n  peer_external_gateway_interface = [PEER_INTERFACE_INDEX]\n  router                       = google_compute_router.[ROUTER_RESOURCE_NAME].name\n  ike_version                  = 2\n}",
                            "description": "Manages a VPN Tunnel resource for HA VPN, connecting to an external VPN gateway via a specific interface.",
                            "why": "To establish the two redundant IPsec tunnels required for an HA VPN connection, each linked to an interface on both the GCP HA VPN Gateway and the on-premises external gateway.",
                            "when": "After configuring an HA VPN Gateway and an external VPN gateway, you create these tunnels to complete the HA VPN setup with dynamic routing via a Cloud Router.",
                            "example": "resource \"google_compute_vpn_tunnel\" \"ha_vpn_tunnel_0\" {\n  name                         = \"ha-vpn-tunnel-0\",\n  region                       = \"us-central1\",\n  ha_vpn_gateway               = google_compute_ha_vpn_gateway.ha_vpn_gw.id,\n  vpn_gateway_interface        = 0,\n  shared_secret                = \"another_secure_secret\",\n  peer_external_gateway        = google_compute_external_vpn_gateway.onprem_external_gw.id,\n  peer_external_gateway_interface = 0,\n  router                       = google_compute_router.main_router.name,\n  ike_version                  = 2\n}\n\nresource \"google_compute_vpn_tunnel\" \"ha_vpn_tunnel_1\" {\n  name                         = \"ha-vpn-tunnel-1\",\n  region                       = \"us-central1\",\n  ha_vpn_gateway               = google_compute_ha_vpn_gateway.ha_vpn_gw.id,\n  vpn_gateway_interface        = 1,\n  shared_secret                = \"yet_another_secure_secret\",\n  peer_external_gateway        = google_compute_external_vpn_gateway.onprem_external_gw.id,\n  peer_external_gateway_interface = 1,\n  router                       = google_compute_router.main_router.name,\n  ike_version                  = 2\n}",
                            "version": "Google Provider >= 4.0"
                        }
                    ]
                }
            ]
        }
    ]
}